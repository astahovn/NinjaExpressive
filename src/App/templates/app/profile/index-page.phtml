<?php
/** @var array $profile */
/** @var array $conversations */
?>

<?php $this->layout('layout::profile', ['title' => 'Profile']) ?>

<div class="row">
    <div class="col-sm-4">
        <div class="panel panel-default">
            <div class="panel-heading">
                <a href="/profile/edit" class="float-right">Edit</a>
                Profile
            </div>
            <div class="panel-body" id="profile-view-block"></div>
        </div>
        <div class="panel panel-default">
            <div class="panel-heading">
                <a href="/conversation/create" class="float-right">Create</a>
                Conversations
            </div>
            <div class="panel-body">
                <div class="hidden" id="conversations">
                    <?= json_encode($conversations) ?>
                </div>
                <div id="conversations_list"></div>
            </div>
        </div>
    </div>
</div>

<?php $this->start('javascript') ?>
<script src="/js/lib/sha256.js"></script>
<script src="/js/lib/tripledes.js"></script>
<script src="/js/lib/jsencrypt.min.js"></script>
<script src="/js/crypto.js"></script>
<script src="/js/profile/index.js"></script>
<script src="/js/mod_profile.js"></script>
<script language="JavaScript">
    ReactDOM.render(
        React.createElement(ProfileViewBlock, {nick: '<?= $profile['nick'] ?>', hasOpenKey: '<?= $profile['has_open_key'] ?>'}, null),
        document.getElementById('profile-view-block')
    );
</script>
<?php $this->stop() ?>